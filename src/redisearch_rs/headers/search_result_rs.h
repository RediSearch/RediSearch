#pragma once

/* Warning, this file is autogenerated by cbindgen from `src/redisearch_rs/c_entrypoint/search_result_ffi/build.rs. Don't modify it manually. */

#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include "rlookup.h"
#include "redisearch.h"
#include "score_explain.h"
#include "types_rs.h"

typedef uint8_t SearchResultFlags;
typedef const RSDocumentMetadata * Option_DocumentMetadata;

/* SearchResult flags */
static const uint8_t Result_ExpiredDoc = 1 << 0;


/**
 * SearchResult - the object all the processing chain is working on.
 * It holds the [`RSIndexResult`] which is what the index scan brought - scores, vectors, flags, etc,
 * and a list of fields loaded by the chain
 */
typedef struct SearchResult {
  t_docId _doc_id;
  double _score;
  /**
   * Raw pointer to the [`ffi::RSScoreExplain`].
   *
   * # Safety
   *
   * The pointer must be a [valid] pointer to a [`ffi::RSScoreExplain`] and must
   * **stay** valid for the entire lifetime of the returned [`SearchResult`].
   *
   * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
   */
  RSScoreExplain *_score_explain;
  Option_DocumentMetadata _document_metadata;
  const RSIndexResult *_index_result;
  RLookupRow _row_data;
  SearchResultFlags _flags;
} SearchResult;

#ifdef __cplusplus
extern "C" {
#endif // __cplusplus

/**
 * Overrides the contents of `dst` with those from `src` taking ownership of `src`.
 * Ensures proper cleanup of any existing data in `dst`.
 *
 * # Safety
 *
 * 1. `dst` must be a [valid], non-null pointer to a [`SearchResult`].
 * 2. `src` must be a [valid], non-null pointer to a [`SearchResult`].
 * 3. `src` must not be used again.
 *
 * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
 */
void SearchResult_Override(struct SearchResult *dst, struct SearchResult *src);

/**
 * Clears the [`SearchResult`] pointed to by `res`, removing all values from its [`RLookupRow`][ffi::RLookupRow].
 * This has no effect on the allocated capacity of the lookup row.
 *
 * # Safety
 *
 * 1. `res` must be a [valid], non-null pointer to a [`SearchResult`].
 *
 * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
 */
void SearchResult_Clear(struct SearchResult *res);

/**
 * Destroys the [`SearchResult`] pointed to by `res` releasing any resources owned by it.
 * This method takes ownership of the search result, therefore the pointer must **must not** be used again after this function is called.
 *
 * # Safety
 *
 * 1. `res` must be a [valid], non-null pointer to a [`SearchResult`].
 * 2. `res` **must not** be used again after this function is called.
 *
 * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
 */
void SearchResult_Destroy(struct SearchResult *res);

/**
 * Moves the contents the [`SearchResult`] pointed to by `res` into a new heap allocation.
 * This method takes ownership of the search result, therefore the pointer must **must not** be used again after this function is called.
 *
 * # Safety
 *
 * 1. `res` must be a [valid], non-null pointer to a [`SearchResult`].
 * 2. `res` **must not** be used again after this function is called.
 *
 * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
 */
struct SearchResult *SearchResult_AllocateMove(struct SearchResult *res);

/**
 * Destroys the [`SearchResult`] pointed to by `res` releasing any resources owned by it.
 * This method takes ownership of the search result, therefore the pointer must **must not** be used again after this function is called.
 *
 * # Safety
 *
 * 1. `res` must be a [valid], non-null pointer to a [`SearchResult`].
 * 2. `res` **must not** be used again after this function is called.
 *
 * [valid]: https://doc.rust-lang.org/std/ptr/index.html#safety
 */
void SearchResult_DeallocateDestroy(struct SearchResult *res);

#ifdef __cplusplus
}  // extern "C"
#endif  // __cplusplus
