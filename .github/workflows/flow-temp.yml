name: temporary testing

on:
  push:
    branches-ignore: ['*'] # ignore all branches

jobs:
  test-caching:
    uses: ./.github/workflows/flow-build-artifacts.yml
    secrets: inherit
    with:
      platform: ubuntu:jammy
      architecture: x86_64

  test-caching-with-reference:
    uses: ./.github/workflows/flow-build-artifacts.yml
    secrets: inherit
    with:
      reference: b96698c689e7eabd54a96cbee887024e0bf89f7d
      platform: ubuntu:jammy
      architecture: x86_64

  phase-2-test-caching:
    needs: test-caching
    uses: ./.github/workflows/flow-build-artifacts.yml
    secrets: inherit
    with:
      platform: ubuntu:jammy
      architecture: x86_64

  phase-2-test-caching-with-reference:
    needs: test-caching-with-reference
    uses: ./.github/workflows/flow-build-artifacts.yml
    secrets: inherit
    with:
      reference: ${{ github.sha }}
      platform: ubuntu:jammy
      architecture: x86_64
