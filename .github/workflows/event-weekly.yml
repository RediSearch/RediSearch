name: Weekly Flow

# Documentation: https://redislabs.atlassian.net/wiki/spaces/DX/pages/3967844669/RediSearch+CI+refactor

on:
  schedule:
    - cron: "0 0 * * 0"

jobs:
  run-benchmarks:
    uses: ./.github/workflows/benchmark-runner.yml
    secrets: inherit
    with:
      extended: true

  deploy-milestone-artifacts:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        branch: [2.6, 2.8, 2.10]
    steps:
      - name: Dummy check for changes
        id: check
        run: |
          echo "Dummy check for changes on branch ${{ matrix.branch }}"
          echo "has_changes=true" >> $GITHUB_OUTPUT
      - name: Dummy deploy
        if: steps.check.outputs.has_changes == 'true'
        run: echo "Dummy milestone deploy for branch ${{ matrix.branch }} (callable workflow with parameters)"
