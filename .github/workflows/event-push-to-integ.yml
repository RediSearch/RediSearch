name: Push to Master or Version Branch

# Documentation: https://redislabs.atlassian.net/wiki/spaces/DX/pages/3967844669/RediSearch+CI+refactor

on:
  push:
    branches:
      - master
      - '[0-9]+.[0-9]+'

jobs:
  docs-only: # Check whether the PR is only modifying docs
    uses: ./.github/workflows/task-check-docs.yml

  deploy-snapshot:
    secrets: inherit
    uses: ./.github/workflows/flow-build-artifacts.yml

  benchmark:
    needs: [docs-only]
    if: needs.docs-only.outputs.only-docs-changed == 'false'
    uses: ./.github/workflows/benchmark-runner.yml
    secrets: inherit
