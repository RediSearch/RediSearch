name: "search-ftsb-10K-enwiki_abstract-hashes-fulltext-aggregate-limit-0-100"
description: "
             Baseline for FT.AGGREGATE without SORTBY/GROUPBY (no depleter).
             Compare with search-ftsb-10K-enwiki_abstract-hashes-fulltext-aggregate-limit-0-100-withcount.yml
             to measure the overhead of WITHCOUNT when there is no SORTBY/GROUPBY.

             - name: enwiki-abstract [details here](https://github.com/RediSearch/ftsb/blob/master/docs/enwiki-abstract-benchmark/description.md),
                     from English-language Wikipedia:Database page abstracts.
                     This use case generates 3 TEXT fields per document, and focusses on full text queries performance.
                     Specifically for this testcase:
                      - Type (read/write/mixed): read
                      - Query type: FT.AGGREGATE with LIMIT (no SORTBY/GROUPBY)
                      - Query sample: FT.AGGREGATE without sorting
             - total docs: 5.9 million
             - fields per doc: 3 TEXT sortable fields
             - average doc size: 227 bytes
             "

metadata:
  component: "search"
setups:
  - oss-standalone
  - oss-standalone-threads-6
  - oss-cluster-04-primaries
  - oss-cluster-04-primaries-threads-6
  - oss-cluster-16-primaries
  - oss-cluster-32-primaries

dbconfig:
  - dataset_name: "ftsb-10K-enwiki_abstract-hashes"
  - init_commands:
    - '"FT.CREATE" "enwiki_abstract" "ON" "HASH" "SCHEMA" "title" "text" "SORTABLE" "url" "text" "SORTABLE" "abstract" "text" "SORTABLE"'
  - tool: ftsb_redisearch
  - parameters:
    - workers: 64
    - reporting-period: 1s
    - input: "https://s3.amazonaws.com/benchmarks.redislabs/redisearch/datasets/enwiki_abstract-hashes-wildcard/enwiki_abstract-hashes-wildcard.redisearch.commands.SETUP.csv"
  - check:
      keyspacelen: 10000
clientconfig:
  benchmark_type: "read-only"
  tool: memtier_benchmark
  arguments: "--test-time 120 -c 32 -t 1 --hide-histogram --command 'FT.AGGREGATE enwiki_abstract * LOAD * LIMIT 0 100'"

